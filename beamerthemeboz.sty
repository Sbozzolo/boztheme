% Boz beamer theme

% Author: Gabriele Bozzola <sbozzolator@gmail.com>
% Date:   01/06/2018

% REQUIRES XELATEX OR LUALATEX

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Based on hsrmtheme:
% Name           : hsrmthemeboz.sty
% Author         : Benjamin Weiss (benjamin.weiss@kreatiefton.de)
% Version        : 0.4
% Created on     : 05.05.2013
% Last Edited on : 24.03.2014
% Copyright      : Copyright (c) 2013-2014 by Benjamin Weiss. All rights reserved.
% License        : This file may be distributed and/or modified under the
%                  GNU Public License.
% Description    : Beamer theme that complies with the corporate design of
%                  the RheinMain University of Applied Sciences.
%                   --> http://www.hs-rm.de
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\ProvidesPackage{beamerthemeboz}[2018/05/05]
\NeedsTeXFormat{LaTeX2e}


\usepackage{eso-pic}

\mode<presentation>

\DeclareOptionBeamer{noserifmath}[true]{\def\beamer@boz@doSans{#1}}

\DeclareOptionBeamer{logo}[true]{\def\beamer@boz@doLogo{#1}}
\DeclareOptionBeamer{nobackground}[true]{\def\beamer@boz@nobackground{#1}}

\DeclareOptionBeamer{nofira}[true]{\def\beamer@boz@doNoFira{#1}}

\DeclareOptionBeamer{nosectionpages}[true]{\def\beamer@boz@doSectionPage{#1}}

\def\beamer@boz@backgroundwidth{1}
\DeclareOptionBeamer{backgroundwidth}{\def\beamer@boz@backgroundwidth{#1}}

\def\beamer@boz@backgroundheight{0.2}
\DeclareOptionBeamer{backgroundheight}{\def\beamer@boz@backgroundheight{#1}}

\def\beamer@boz@background{background.pdf}
\DeclareOptionBeamer{background}{\def\beamer@boz@background{#1}}

\ExecuteOptionsBeamer{noserifmath=false, logo=false, nofira=false,
  nosectionpages=false, nobackground=false}
\ProcessOptionsBeamer

\def\beamer@boz@truetext{true}

\newcommand{\conference}{\@dblarg\beamer@conference}
\long\def\beamer@conference[#1]#2{%
  \def\insertconference{#2}  %
  \def\insertshortconference{#1}%
  }
\conference[]{}

%---------------------------------------------------------------------
% TOC
%---------------------------------------------------------------------
% \useoutertheme[subsection=false,shadow]{miniframes}
\setbeamertemplate{section in toc}[sections numbered]
\setbeamertemplate{subsection in toc}[subsections numbered]

%---------------------------------------------------------------------
% custom commands
%---------------------------------------------------------------------
\newcommand{\arrow}{→}
\newcommand{\quoted}[1]{«\emph{#1}»}

%---------------------------------------------------------------------
% Itemize
%---------------------------------------------------------------------
\setbeamertemplate{itemize item}{\arrow}
\setbeamertemplate{itemize subitem}{\arrow}
\setbeamertemplate{itemize subsubitem}{\arrow}

\setlength{\parskip}{0.5em}

%---------------------------------------------------------------------
% Colors
%---------------------------------------------------------------------

% Primary Colors
\definecolor{bozRed}{rgb}{0.882352941,0,0.098039216}
\definecolor{bozRedDark}{rgb}{0.588235294,0,0.058823529}
\definecolor{bozWarmGreyDark}{rgb}{0.374509804,0.354901961,0.335294118}
\definecolor{bozWarmGreyLight}{rgb}{0.866666667,0.847058824,0.82745098}

% Secondary Colors
\definecolor{bozSec1}{rgb}{0,0.588235294,0.509803922}
\definecolor{bozSec1Dark}{rgb}{0,0.392156863,0.31372549}
\definecolor{bozSec1Comp}{rgb}{0.294117647,0.745098039,0.882352941}
\definecolor{bozSec1CompDark}{rgb}{0.196078431,0.490196078,0.568627451}

\definecolor{bozSec2}{rgb}{0.607843137,0.764705882,0.156862745}
\definecolor{bozSec2Dark}{rgb}{0.411764706,0.490196078,0.098039216}
\definecolor{bozSec2Comp}{rgb}{0.254901961,0.156862745,0.509803922}
\definecolor{bozSec2CompDark}{rgb}{0.176470588,0.098039216,0.333333333}

\definecolor{bozSec3}{rgb}{0.509803922,0.078431373,0.31372549}
\definecolor{bozSec3Dark}{rgb}{0.338345865,0.058823529,0.196078431}
\definecolor{bozSec3Comp}{rgb}{1,0.509803922,0}
\definecolor{bozSec3CompDark}{rgb}{0.666666667,0.333333333,0}

% General
\setbeamercolor{normal text}{fg=bozWarmGreyDark}
\setbeamercolor{structure}{fg=bozWarmGreyDark}
\setbeamercolor{alerted text}{fg=bozRed}
\setbeamercolor{example text}{fg=white}
\setbeamercolor{copyright text}{fg=bozWarmGreyLight}
\setbeamercolor{palette primary}{fg=bozWarmGreyDark}
\setbeamercolor{palette secondary}{fg=bozWarmGreyDark,bg=bozWarmGreyLight}
\setbeamercolor{palette tertiary}{fg=black,bg=bozWarmGreyLight}
\setbeamercolor{palette quaternary}{fg=white, bg=bozWarmGreyDark}
% Titlepage
\setbeamercolor{title}{parent=normal text}
\setbeamercolor{subtitle}{parent=normal text}
\setbeamercolor{institute}{parent=normal text}
\setbeamercolor{conference}{parent=normal text}
% Content
\setbeamercolor{frametitle}{parent=palette quaternary}
% Blocks
\setbeamercolor{block title}{parent=palette quaternary}
\setbeamercolor{block body}{parent=palette secondary}
\setbeamercolor{block title example}{fg=white, bg=bozSec1Dark}
\setbeamercolor{block body example}{fg=white, bg=bozSec1}
\setbeamercolor{block title alerted}{fg=white, bg=bozRedDark}
\setbeamercolor{block body alerted}{fg=white, bg=bozRed}
% Notes
\setbeamercolor{note page}{fg=bozWarmGreyDark,bg=bozWarmGreyLight}
\setbeamercolor{note title}{fg=white, bg=bozWarmGreyDark}
\setbeamercolor{note date}{parent=note title}
% Page Number
\setbeamercolor{page number in head/foot}{fg=bozWarmGreyDark}

%---------------------------------------------------------------------
% Fonts
%---------------------------------------------------------------------

% General

% Declare fontfamilys
\ifx \beamer@boz@doNoFira\beamer@boz@truetext
        % Sans serif math option
        \ifx \beamer@boz@doSans\beamer@boz@truetext
                % sans serif math %
                \usepackage[no-math]{fontspec}%
                \setmainfont{Arial}%
        \else%
                % serif math %
                \usepackage{fontspec}%
                \usefonttheme[onlymath]{serif}%
        \fi%
        \newfontfamily\Light{Arial}%
        \newfontfamily\Book{Arial-Bold}%
        \newfontfamily\Medium{Arial-Bold}%
        \setsansfont{Arial}%
\else%
        % Sans serif math option
        \ifx \beamer@boz@doSans \beamer@boz@truetext
                \usepackage[no-math]{fontspec}%
                \setmainfont{Fira Sans Light}%
        \else%
                \usepackage{fontspec}%
                \usefonttheme[onlymath]{serif}%
        \fi%
        \newfontfamily\Light{Fira Sans Light}%
        \newfontfamily\Book{Fira Sans Book}%
        \newfontfamily\Medium{Fira Sans Medium}%
        \setsansfont{Fira Sans Light}%
\fi%

\renewcommand\UrlFont{\Medium}



% Titlepage
\setbeamerfont{title}{family=\Light,size=\fontsize{16}{16}}
\setbeamerfont{subtitle}{family=\Light,size=\fontsize{12}{14}}
\setbeamerfont{date}{size=\fontsize{8}{10}}
\setbeamerfont{author}{size=\fontsize{12}{15}}
\setbeamerfont{institute}{size=\fontsize{8}{10}}
\setbeamerfont{conference}{size=\fontsize{9}{10}}
% Section
\setbeamerfont{section title}{size=\LARGE}
% Content
\setbeamerfont{frametitle}{family=\Light,size=\large}
\setbeamerfont{copyright text}{family=\Light,size=\tiny}
\setbeamerfont{block title}{family=\Book,size=\large}
\setbeamerfont{block title alerted}{family=\Book,size=\large}
\setbeamerfont{alerted text}{family=\Medium}
% Captions
\setbeamerfont{caption name}{family=\Book}

%---------------------------------------------------------------------
% Titlepage
%---------------------------------------------------------------------

% Titlepage structure
\def\maketitle{\ifbeamer@inframe\titlepage\else\frame[plain]{\titlepage}\fi}
\def\titlepage{\usebeamertemplate{title page}}
\setbeamertemplate{title page}
{
        \begin{minipage}[b][\paperheight]{\textwidth}
        \vspace*{5mm}
        \ifx \beamer@boz@doLogo \beamer@boz@truetext
        \hfill\includegraphics[height=14mm]{./logo}\par
        \fi
        \vspace*{5mm}
        \ifx\inserttitle\@empty%
        \else%
        {\usebeamerfont{title}\usebeamercolor[fg]{title}\MakeUppercase{\inserttitle}\par}%
        \vspace*{1mm}
        \fi%
        \ifx\insertsubtitle \@empty
        \else%
                {\usebeamerfont{subtitle}\usebeamercolor[fg]{subtitle}\insertsubtitle\par}%
                \vspace*{5mm}
        \fi%

        \ifx\insertconference\@empty%
        \else%
                \vspace*{4mm}
                {\usebeamerfont{conference}\usebeamercolor[fg]{conference}\insertconference\par}%
        \fi%

        \ifx\insertdate\@empty%
        \else%
                {\usebeamerfont{date}\usebeamercolor[fg]{date}\insertdate\par}%
        \fi%
        
        \ifx \beamer@boz@nobackground \beamer@boz@truetext
        \vspace*{15mm}
        \else
        \vfill
        \begin{center}
          \includegraphics[width=\beamer@boz@backgroundwidth \paperwidth,
                           height = \beamer@boz@backgroundheight \paperheight]
                           {\beamer@boz@background}
        \end{center}
        \vfill
        \fi

        \ifx\insertauthor\@empty%
        \else%
                {\usebeamerfont{author}\usebeamercolor[fg]{author}\insertauthor\par}%
        \fi%
        \ifx\insertinstitut\@empty%
        \else%
                \vspace*{3mm}
                {\usebeamerfont{institute}\usebeamercolor[fg]{institute}\insertinstitute\par}%
        \fi%
        \vspace*{15mm}
        \end{minipage}
}

%---------------------------------------------------------------------
% Sectionpages
%---------------------------------------------------------------------

% Make Sectionhead uppercase
\newcommand{\insertsectionHEAD}{%
        \expandafter\insertsectionHEADaux\insertsectionhead}
        \newcommand{\insertsectionHEADaux}[3]{\MakeUppercase{#3}
}

\ifx \beamer@boz@doSectionPage \beamer@boz@truetext

\@empty

\else
% Insert frame with section title at every section start
\AtBeginSection[]
{
\begingroup
\setbeamercolor{background canvas}{bg=bozWarmGreyDark}
\begin{frame}[plain]
\centering
\vfill\usebeamerfont{section title}\textcolor{white}{\insertsectionHEAD}\vfill
\end{frame}
\endgroup
}
\fi

%---------------------------------------------------------------------
% Frametitle
%---------------------------------------------------------------------
\setbeamertemplate{frametitle}
{
  \vspace{-0.2ex}
\begin{beamercolorbox}[wd=\paperwidth,leftskip=0.3cm,rightskip=0.3cm,ht=3ex,dp=1.5ex]{frametitle}
         \usebeamerfont{frametitle}\MakeUppercase{\insertframetitle}%
\end{beamercolorbox}
}

%---------------------------------------------------------------------
% Footline
%---------------------------------------------------------------------
\usenavigationsymbolstemplate{}
\setbeamertemplate{footline}
{%
\begin{beamercolorbox}[wd=\textwidth,ht=3ex,dp=1.5ex,leftskip=0.3cm,rightskip=0.3cm]{structure}%
\hfill\usebeamerfont{page number in head/foot}%
\insertframenumber%
\end{beamercolorbox}%
}

%---------------------------------------------------------------------
% Captions
%---------------------------------------------------------------------
\setbeamertemplate{caption label separator}{: }

%---------------------------------------------------------------------
% Thank you frame
%---------------------------------------------------------------------

\newcommand{\thankyou}[1]{
\setbeamercolor{background canvas}{bg=bozWarmGreyDark}
\begin{frame}[plain]
  \centering
    \vfill\usebeamerfont{section subtitle}\textcolor{white}{\Medium #1}\vfill  
    \end{frame}
}   

%---------------------------------------------------------------------
% Blocks
%---------------------------------------------------------------------
\setbeamertemplate{block begin}
{
  \setbeamercolor{item}{parent=block body}
  \par\vskip\medskipamount%
  \begin{beamercolorbox}[sep=.5ex,dp=0.6ex,leftskip=0.5ex,rightskip=0.5ex]{block title}
    \usebeamerfont*{block title}\insertblocktitle%
  \end{beamercolorbox}%
  {\parskip0pt\par}%
  {\nointerlineskip\vskip-0.5pt}%
  \usebeamerfont{block body}%
  \begin{beamercolorbox}[sep=.5ex,dp=0.6ex,leftskip=0.5ex,rightskip=0.5ex,vmode]{block body}%
}
\setbeamertemplate{block end}
{\end{beamercolorbox}\vskip\smallskipamount}

\setbeamertemplate{block alerted begin}
{
  \setbeamercolor{item}{parent=block body alerted}
  \par\vskip\medskipamount%
  \begin{beamercolorbox}[sep=.5ex,dp=0.6ex,leftskip=0.5ex,rightskip=0.5ex]{block title alerted}
    \usebeamerfont*{block title alerted}\insertblocktitle%
  \end{beamercolorbox}%
  {\parskip0pt\par}%
  {\nointerlineskip\vskip-0.5pt}%
  \usebeamerfont{block body alerted}%
  \begin{beamercolorbox}[sep=.5ex,dp=0.6ex,leftskip=0.5ex,rightskip=0.5ex,vmode]{block body alerted}%
}
\setbeamertemplate{block alerted end}
{\end{beamercolorbox}\vskip\smallskipamount}

\setbeamertemplate{block example begin}
{
  \par\vskip\medskipamount%
  \begin{beamercolorbox}[sep=.5ex,dp=0.6ex,leftskip=0.5ex,rightskip=0.5ex]{block title example}
    \usebeamerfont*{block title example}\insertblocktitle%
  \end{beamercolorbox}%
  {\parskip0pt\par}%
  {\nointerlineskip\vskip-0.5pt}%
  \usebeamerfont{block body example}%
  \begin{beamercolorbox}[sep=.5ex,dp=0.6ex,leftskip=0.5ex,rightskip=0.5ex,vmode]{block body example}%
}
\setbeamertemplate{block example end}
{\end{beamercolorbox}\vskip\smallskipamount}

%---------------------------------------------------------------------
% Images
%---------------------------------------------------------------------

\newbox\mytempbox
\newdimen\mytempdimen

\newcommand\includegraphicscopyright[3][]{%
  \leavevmode\vbox{\vskip3pt\raggedright\setbox\mytempbox=\hbox{\includegraphics[#1]{#2}}%
    \mytempdimen=\wd\mytempbox\box\mytempbox\par\vskip1pt%
    \usebeamerfont{copyright text}{\usebeamercolor[fg]{copyright text}{\vbox{\hsize=\mytempdimen#3}}}\vskip3pt%
}}

\mode
<all>